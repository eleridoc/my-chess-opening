<div class="app-page">
	<div class="explorer-layout">
		<!-- Left column: game info + tabs -->
		<section class="explorer-col explorer-col--left app-container">
			<app-explorer-game-info-panel [facade]="facade"></app-explorer-game-info-panel>

			<div class="explorer-left-tabs">
				<mat-tab-group mat-stretch-tabs="false" mat-align-tabs="end">
					<mat-tab>
						<ng-template mat-tab-label>
							<mat-icon class="app-tab-icon">content_paste_go</mat-icon>
							Import
						</ng-template>

						<app-explorer-import
							[disabled]="facade.promotionPending() !== null"
							[fenError]="facade.importFenError()"
							[pgnError]="facade.importPgnError()"
							(applyFen)="onApplyFen($event)"
							(applyPgn)="onApplyPgn($event)"
							(clearFenError)="facade.clearImportFenError()"
							(clearPgnError)="facade.clearImportPgnError()"
						/>
					</mat-tab>

					<mat-tab disabled>
						<ng-template mat-tab-label>
							<mat-icon class="app-tab-icon">timeline</mat-icon>
							Analysis
						</ng-template>
						Content 1
					</mat-tab>

					<mat-tab disabled>
						<ng-template mat-tab-label>
							<mat-icon class="app-tab-icon">share</mat-icon>
							Export
						</ng-template>

						Content 4
					</mat-tab>
				</mat-tab-group>
			</div>
		</section>

		<!-- Center column: players + board + controls -->
		<section class="explorer-col explorer-col--center" #centerCol>
			<div #topPlayerWrap class="explorer-center-row">
				<app-player-info-card
					position="top"
					[header]="facade.gameInfoHeaderVm()"
				></app-player-info-card>
			</div>

			<div
				#boardArea
				class="explorer-board-area"
				[style.width.px]="boardSizePx()"
				[style.height.px]="boardSizePx()"
			>
				<app-chess-board
					[fen]="facade.fen()"
					[orientation]="facade.boardOrientation()"
					[inputEnabled]="inputEnabled()"
					[validateMoveAttempt]="validateMoveAttempt"
					[lastMoveSquares]="facade.lastMoveSquares()"
					[getLegalDestinationsFrom]="getLegalDestinationsFrom"
					[getLegalCaptureDestinationsFrom]="getLegalCaptureDestinationsFrom"
				/>
			</div>

			<div #bottomPlayerWrap class="explorer-center-row">
				<app-player-info-card
					position="bottom"
					[header]="facade.gameInfoHeaderVm()"
				></app-player-info-card>
			</div>

			<div
				#controlsWrap
				class="explorer-center-row explorer-center-row--controls app-container-fit"
			>
				<app-board-controls
					#boardControls
					[canStart]="facade.canStart()"
					[canPrev]="facade.canPrev()"
					[canNext]="facade.canNext()"
					[canEnd]="facade.canEnd()"
					(rotate)="onRotateBoard()"
					(reset)="onReset()"
					(start)="onStart()"
					(prev)="onPrev()"
					(next)="onNext()"
					(end)="onEnd()"
				/>
			</div>

			<!-- Optional: keep a spacer at the bottom to absorb remaining height -->
			<!-- <div class="explorer-center-spacer"></div> -->
		</section>

		<!-- Right column: split into 2 equal blocks (top/bottom) -->
		<section class="explorer-col explorer-col--right">
			<div class="explorer-right-block explorer-right-block--top">
				<app-move-list
					[rows]="facade.moveListRows()"
					[variationsByNodeId]="facade.variationsByNodeId()"
					[currentNodeId]="facade.currentNodeId()"
					(nodeSelected)="onNodeSelected($event)"
				></app-move-list>
			</div>

			<div class="explorer-right-block explorer-right-block--bottom">
				<div class="app-card-flat">
					<div class="app-card-flat-top">Movements played</div>
					<div class="app-card-flat-content-fit">
						<div class="explorer-right-bottom__placeholder">Coming soonâ€¦</div>
					</div>
				</div>
			</div>
		</section>
	</div>
</div>
