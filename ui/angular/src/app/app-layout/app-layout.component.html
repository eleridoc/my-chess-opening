<div class="app-shell">
	<mat-toolbar class="app-topbar" role="banner">
		<a
			class="app-topbar__logo"
			[routerLink]="hasAccounts() ? '/dashboard' : '/getting-started'"
			aria-label="My Chess Opening"
		>
			<img src="/app-logo-256.png" alt="My Chess Opening" />
		</a>

		<nav
			mat-tab-nav-bar
			class="app-topbar__nav"
			aria-label="Primary navigation"
			[tabPanel]="tabPanel"
		>
			@for (item of topNav(); track item.path) {
				<a
					mat-tab-link
					[routerLink]="item.path"
					routerLinkActive
					#rla="routerLinkActive"
					[active]="rla.isActive"
					[attr.aria-current]="rla.isActive ? 'page' : null"
				>
					{{ item.label }}
				</a>
			}
		</nav>

		<span class="app-topbar__spacer"></span>

		@if (hasAccounts()) {
			<!--
				Import CTA:
				- Enabled only when no import is currently running.
				- When an import is running, we keep the user informed via label + disabled state.
			-->
			<button
				mat-stroked-button
				class="mat-stroked-button-d-5"
				(click)="onImportNowClick()"
				[disabled]="importState.isImporting()"
				[attr.aria-disabled]="importState.isImporting() ? 'true' : null"
			>
				<mat-icon aria-hidden="true">download</mat-icon>
				<span>{{ importState.isImporting() ? 'Importingâ€¦' : 'Import now' }}</span>
			</button>
		}

		<button mat-icon-button (click)="theme.toggle()" aria-label="Toggle theme">
			<mat-icon aria-hidden="true">
				{{ theme.isDark() ? 'light_mode' : 'dark_mode' }}
			</mat-icon>
		</button>

		<!-- Settings menu -->
		<button mat-icon-button [matMenuTriggerFor]="settingsMenu" aria-label="Settings and accounts">
			<mat-icon aria-hidden="true">settings</mat-icon>
		</button>

		<mat-menu #settingsMenu="matMenu">
			@if (hasAccounts()) {
				<button mat-menu-item routerLink="/settings">
					<mat-icon aria-hidden="true">settings</mat-icon>
					<span>Settings</span>
				</button>
			}

			<button mat-menu-item routerLink="/chess-accounts">
				<mat-icon aria-hidden="true">manage_accounts</mat-icon>
				<span>Chess accounts</span>
			</button>
		</mat-menu>

		<!-- Help menu -->
		<button mat-icon-button [matMenuTriggerFor]="helpMenu" aria-label="Help and more">
			<mat-icon aria-hidden="true">help_outline</mat-icon>
		</button>

		<mat-menu #helpMenu="matMenu">
			@if (hasAccounts()) {
				<button mat-menu-item routerLink="/logs">
					<mat-icon aria-hidden="true">receipt_long</mat-icon>
					<span>Logs</span>
				</button>
			}

			<button mat-menu-item routerLink="/about">
				<mat-icon aria-hidden="true">info</mat-icon>
				<span>About</span>
			</button>

			<button mat-menu-item routerLink="/faq">
				<mat-icon aria-hidden="true">quiz</mat-icon>
				<span>FAQ</span>
			</button>
		</mat-menu>
	</mat-toolbar>

	<!-- Required by mat-tab-nav-bar in Angular Material v21 -->
	<mat-tab-nav-panel #tabPanel class="app-panel">
		<main class="app-content" role="main">
			<router-outlet />
		</main>
	</mat-tab-nav-panel>
</div>
