<div class="game-info-panel">
	<ng-container *ngIf="facade.gameInfoHeaderVm() as header">
		<div class="game-info-panel__meta-header">
			<app-game-meta-header-card [header]="header"></app-game-meta-header-card>
		</div>

		<div class="game-info">
			<div
				class="game-info__result"
				[class.game-info__result--good]="header.result?.tone === 'good'"
				[class.game-info__result--bad]="header.result?.tone === 'bad'"
				[class.game-info__result--neutral]="header.result?.tone === 'neutral'"
			>
				{{ resultText(header.result?.key) }}
			</div>
		</div>

		<div class="app-separator"></div>

		<div class="game-info">
			<ng-container *ngIf="header.opening as op; else openingEmpty">
				<ng-container *ngIf="op.name || op.eco; else openingEmpty">
					<span class="game-info__opening-label">Opening : </span>

					<span
						class="game-info__opening-name"
						[class.game-info__opening-name--deduced]="op.nameIsDeduced"
						[matTooltip]="
							op.nameIsDeduced ? op.deducedLinePgn || 'Deduced opening name (best-effort).' : ''
						"
						[matTooltipDisabled]="!op.nameIsDeduced"
					>
						{{ op.name || '—' }}
					</span>

					<span
						*ngIf="op.nameIsDeduced"
						class="game-info__opening-deduced"
						[matTooltip]="
							op.deducedMatchPly != null
								? 'Deduced from ECO + moves. Matched ' +
									op.deducedMatchPly +
									' plies (best-effort).'
								: 'Deduced from ECO + moves (best-effort).'
						"
					>
						≈
					</span>

					<span
						*ngIf="op.eco as eco"
						class="game-info__eco"
						[matTooltip]="op.ecoIsDeduced ? 'Provider ECO: ' + (op.providerEco || '—') : ''"
						[matTooltipDisabled]="!op.ecoIsDeduced"
					>
						({{ eco }})
					</span>

					<span
						*ngIf="op.ecoIsDeduced"
						class="game-info__eco-deduced"
						matTooltip="ECO determined by the app (best-effort)."
					>
						!
					</span>
				</ng-container>
			</ng-container>

			<ng-template #openingEmpty>—</ng-template>
		</div>

		<div class="app-separator"></div>
	</ng-container>
</div>
